{"version":3,"sources":["webpack:///./src/app/pages/pin-confirm/pin-confirm.module.ts","webpack:///./src/app/pages/pin-confirm/pin-confirm.page.html","webpack:///./src/app/pages/pin-confirm/pin-confirm.page.scss","webpack:///./src/app/pages/pin-confirm/pin-confirm.page.ts"],"names":[],"mappings":"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","file":"pages-pin-confirm-pin-confirm-module.js","sourcesContent":["import { RouterModule } from '@angular/router';\nimport { NgModule } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { PinConfirmPage } from './pin-confirm.page';\nimport { ComponentsModule } from '../../components/components.module'\n\n@NgModule({\n  imports: [\n    ComponentsModule,\n    FormsModule,\n    RouterModule.forChild([{ path: '', component: PinConfirmPage }])\n  ],\n  declarations: [PinConfirmPage]\n})\nexport class PinConfirmPageModule {}\n","module.exports = \"<ion-header>\\n    <ion-toolbar>\\n        <ion-buttons slot=\\\"start\\\">\\n            <ion-back-button text=\\\"Back\\\"></ion-back-button>\\n        </ion-buttons>\\n        <ion-title text-center>\\n            <app-logo></app-logo>\\n        </ion-title>\\n    </ion-toolbar>\\n</ion-header>\\n<ion-content padding>\\n    <loading top=\\\"35%\\\" *ngIf=\\\"loading; else confirmPin\\\"></loading>\\n    <ng-template #confirmPin>\\n        <ion-grid full-height no-padding>\\n            <ion-row full-height no-padding>\\n                <ion-col height-20 size=\\\"12\\\" text-center align-items-start>\\n                    <div margin-vertical *ngIf=\\\"isPinConfirm; else pinCode\\\">\\n                        <h3 title no-margin>CONFIRM SECURITY PIN</h3>\\n                        <p>Re-enter your PIN</p>\\n                    </div>\\n                    <ng-template #pinCode>\\n                        <div margin-vertical>\\n                            <h3 title no-margin>ENTER YOUR SECURITY PIN</h3>\\n                            <p>Security PIN should be 6 di-git numbers</p>\\n                        </div>\\n                    </ng-template>\\n                </ion-col>\\n                <ion-col height-65 size=\\\"12\\\" align-items-stretch>\\n                    <pin-code (change)=\\\"onChange($event)\\\"></pin-code>\\n                </ion-col>\\n                <ion-col height-15 size=\\\"12\\\" align-items-end no-padding>\\n                    <ion-row align-items-end full-height no-padding>\\n                        <ion-col padding-bottom>\\n                            <ion-button [disabled]=\\\"pin.length <= 5\\\" (click)=\\\"continue()\\\" align-items-end shadow expand=\\\"block\\\">Continue</ion-button>\\n                        </ion-col>\\n                    </ion-row>\\n                </ion-col>\\n            </ion-row>\\n        </ion-grid>\\n    </ng-template>\\n</ion-content>\"","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3BhZ2VzL3Bpbi1jb25maXJtL3Bpbi1jb25maXJtLnBhZ2Uuc2NzcyJ9 */\"","import { Component } from '@angular/core';\nimport { NavController } from '@ionic/angular';\nimport { HttpResponse } from \"@angular/common/http\";\n// import { HttpResponse } from \"@angular/common/http\";\n// import { KeycloakService } from 'keycloak-angular';\nimport { AppGlobals } from '../../app.globals'\nimport { MozoService } from '../../services/mozo.service'\nimport { AppService } from '../../app.service'\nimport Utils from '../../utils'\n\n@Component({\n  selector: 'app-pin-confirm',\n  templateUrl: 'pin-confirm.page.html',\n  styleUrls: ['pin-confirm.page.scss']\n})\nexport class PinConfirmPage {\n\n  public loading: boolean = false\n  public isPinConfirm: boolean = true\n  private pin: string = \"\"\n\n  constructor(\n    private appGlobals: AppGlobals,\n    private nav: NavController,\n    private mozoService: MozoService,\n    private appService: AppService,\n  ) {\n    if (this.appGlobals.encryptSeedWord) {\n      this.isPinConfirm = false\n    }\n  }\n\n  onChange(pin: string) {\n    console.log(\"code\", pin)\n    this.pin = pin\n  }\n\n  continue() {\n    this.loading = true\n    if (this.pin.length > 0) {\n      let mnemonic = this.appGlobals.seedWord\n      if (this.appGlobals.encryptSeedWord) {\n        mnemonic = Utils.encryption.decrypt(this.appGlobals.encryptSeedWord, this.pin)\n      }\n\n      console.log(\"mnemonic\", mnemonic)\n\n\n      let wallet = Utils.wallet.generateWallets(mnemonic)\n\n      let address = Utils.wallet.generateAddressAtIndex(wallet, 0)\n      \n\n      if (address) {\n        address['privkey'] = Utils.encryption.encrypt(address['privkey'], this.pin)\n\n        console.log(\"address\", address)   \n           \n        let saveAddress = () => {\n          this.appGlobals.address = address.address\n          this.appService.addSetting({\n            \"Address\": address\n          }).then((data) => {\n            console.log(data)\n          }, (error) => {\n            console.log(error)\n          })\n        }\n\n        if (this.appGlobals.seedWord) {\n          let repData = {\n            encryptSeedPhrase: Utils.encryption.encrypt(mnemonic, this.pin),\n            offchainAddress: address.address\n          };\n          this.mozoService.updateWalletInfo(repData).subscribe((res: HttpResponse<any>) => {\n            const data = res.body;\n\n            console.log(\"user\", data)\n            saveAddress()\n            this.nav.navigateRoot('/app/tabs/(my-wallet:my-wallet)')\n\n          }, (error) => {\n            console.log(\"error\", error)\n          })\n        } else {\n          saveAddress()\n          this.nav.navigateRoot('/app/tabs/(my-wallet:my-wallet)')\n        }\n      }\n\n    }\n\n  }\n\n}\n"],"sourceRoot":""}